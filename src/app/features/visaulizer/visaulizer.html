<div class="visualizer">
  <canvas #canvas aria-label="Audio visualizer"></canvas>

  <app-shader-prompter
    [promptControl]="promptControl"
    [generationStatus]="promptStatus()"
    [errorMessage]="promptError()"
    [disabled]="isPromptGenerating()"
    [isLoading]="isPromptGenerating()"
    [generatedActive]="isGeneratedShaderActive()"
    (generate)="onGeneratePrompt()"
  />

  <app-shader-control-panel
    [controls]="shaderControls()"
    (controlsChange)="onShaderControlsChange($event)"
  />

  <app-audio-controller
    [urlControl]="urlControl"
    [isPlaying]="isPlaying()"
    [isLiveSourceActive]="isLiveSourceActive()"
    [activeSourceLabel]="activeSourceLabel()"
    [selectedTrackName]="selectedTrackName()"
    [statusLabel]="statusLabel()"
    [isCollapsed]="isControllerCollapsed()"
    [selectedPresetId]="selectedPresetId()"
    [presets]="presetOptions"
    (fileSelected)="onFileSelected($event)"
    (useMicrophone)="onUseMicrophone()"
    (useSystemAudio)="onUseSystemAudio()"
    (stopLiveSource)="onStopLiveSource()"
    (loadUrl)="onLoadUrl()"
    (togglePlayback)="onTogglePlayback()"
    (stop)="onStop()"
    (selectPreset)="onSelectPreset($event)"
    (toggleController)="toggleController()"
  />

  <audio
    #audio
    crossorigin="anonymous"
    preload="metadata"
    (play)="onAudioPlay()"
    (pause)="onAudioPause()"
  ></audio>
</div>
